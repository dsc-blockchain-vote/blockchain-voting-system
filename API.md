# Authentication

## `POST /api/login`

Creates a session cookie to authenticate user  
Valid for 59 minutes because the token generated by firebase is valid for 60 minutes

### Request JSON

{  
&emsp;`idToken` - the idToken generated by firebase on authentication from client side  
}

### Response

- `Status code`: 200
  - `Return`: "Success"
- `Status code`: 401
  - `Return`: "Unauthorized"

## `GET /api/logout`

Clear session cookies

### Request JSON

- No parameters

### Response

- No return

## `POST /api/register`

- Register a new user

### Request JSON

{  
&emsp;`name`: name of user,  
&emsp;`email`: email address of user,  
&emsp;`password`: password of user,  
&emsp;`isOrganizer`: true if the new user is an organizer, otherwise false  
}

### Response

- `Status code`: 200
  - `Return`: "User successfully registered"
- `Status code`: 400
  - `Return`: "bad request"

# Organizer

## `POST /api/election/create`

Store the data of new election in database

### Request JSON

{  
&emsp;`candidates`: array of candidates,  
&emsp;`startTime`: start time of election in UTC time,  
&emsp;`endTime`: end time of election in UTC time,  
&emsp;`validVoters`: array of voter IDs that are to be validated,  
&emsp;`electionName`: name of the election,  
}

### Response

- `Status code`: 200
  - `JSON returned`:  
    {  
     &emsp;`electionID`: "ID of the election generated by firebase"  
     }
- `Status code`: 401
  - `Return`: "Unauthorized"
- `Status code`: 400
  - `Return`: "bad request"

## `PUT /api/election/{electionID}/deploy`

Deploys the election contract and validates voters

### URL parameter

- `electionID`: election ID of the election whose contract has to be deployed

### Request JSON

- EMPTY

### Response

- `Status code`: 200

  - `JSON returned`:  
    {  
    &emsp;`electionID`: ID of the election,  
    &emsp;`electionAddress`: Address of the contract on the blockchain,  
    &emsp;`invalidVoterIDs`: array of voter IDs that failed to be validated  
    }

- `Status code`: 206
  - Indicates that the election has already been deployed
  - `JSON returned`:  
    {  
     &emsp;`electionAddress`: "Address of the contract"  
    }
- `Status code`: 401

  - `Return`: "Unauthorized"

- `Status code`: 400
  - `Return`: "bad request"

## `PUT /api/election/{electionID}/validate`

validate the list of voter IDs

### URL Paramter

- `electionID`: election ID of the corresponding election

### Request JSON

{  
 &emsp;`validVoters`: array of voter IDs that are to be validated  
}

### Response

- `Status code`: 200

  - `JSON returned`:  
    {  
    &emsp;`invalidVoterIDs`: array of voter IDs that failed to be validated,  
    }

- `Status code`: 401

  - `Return`: "Unauthorized"

- `Status code`: 400
  - `Return`: "bad request"

## `GET /api/election/`

gets all the elections that this organizer has

### Request JSON

- EMPTY

### Response

- `Status code`: 200

  - `JSON returned`:  
    {  
     &emsp;"ELECTION ID": {  
     &emsp;&emsp;`candidates`: array of candidates,  
     &emsp;&emsp;`endTime`: end time of election in UTC in ISO format,  
     &emsp;&emsp;`startTime`: start time of election in UTC is ISO format,  
     &emsp;&emsp;`electionName`: name of election,  
     &emsp;&emsp;`organizerName`: name of organizer,  
     &emsp;&emsp;`organizerID`: ID of the organizer,  
     &emsp;&emsp; `validVoters`: list of valid voters,  
     &emsp;&emsp; `address`: address of deployed contract  
     &emsp;&emsp;}  
     }
    - Note the "ELECTION ID" is actually the alphanumeric ID of an election and not literally the words "ELECTION ID".
    - So this JSON will contain objectes whose keys are the ELECTION ID of the organizer's election and each ELECTION ID will contain the fields mentioned above.
    - The `address` field will exist only if the contract has been deployed

- `Status code`: 401
  - `Return`: "Unauthorized"
- `Status code`: 400
  - `Return`: "bad request"

## `GET /api/election/{electionID}`

Get the details of a particular election

### URL parameter

- `electionID`: ID of the election

### Request JSON

- EMPTY

### Response

- `Status code`: 200

  - `JSON returned`:  
    {  
     &emsp;`candidates`: array of candidates,  
     &emsp;`endTime`: end time of election in UTC in ISO format,  
     &emsp;`startTime`: start time of election in UTC is ISO format,  
     &emsp;`electionName`: name of election,  
     &emsp;`organizerName`: name of organizer,  
     &emsp;`organizerID`: ID of the organizer,  
     &emsp; `validVoters`: list of valid voters,  
     &emsp; `address`: address of deployed contract  
    }
    - The `address` field will exist only if the contract has been deployed

- `Status code`: 401

  - `Return`: "Unauthorized"

- `Status code`: 400
  - `Return`: "bad request"

# Voter

## `PUT /api/election/{electionID}/vote`

End point to caste the vote

### URL paramters

- `electionID`: ID of the election in which the vote is to be casted

### Request JSON

{  
 &emsp;`candidateID`: index of the candidate to be voted for
}

- `candidates` are indexed like an array starting from 0

### Response

- `Status code`: 200
  - `JSON returned`:  
    {  
     &emsp;`transaction hash`: hash of the transaction that occurs on the blockchain when the vote is casted  
    }
- `Status code`: 401

  - `Return`: "Unauthorized"

- `Status code`: 400
  - `Return`: One of the following will be returned:
    - "bad request"
    - "Not a valid voter"
    - "Vote has already been cast"

## `GET /api/election/`

Gets the elections for which the voter is valid for. These elections are divided into previous, upcoming and ongoing elections

### Request JSON

- EMPTY

### Response

- `Status code`: 200

  - `JSON returned`:  
    {  
    &emsp;`Upcoming`: {..."ELECTION ID"...},  
    &emsp;`Previous`: {..."ELECTION ID"...},  
    &emsp;`Ongoing`: {  
     &emsp;&emsp;"ELECTION ID": {  
     &emsp;&emsp;&emsp;`candidates`: array of candidates,  
     &emsp;&emsp;&emsp;`endTime`: end time of election in UTC in ISO format,  
     &emsp;&emsp;&emsp;`startTime`: start time of election in UTC is ISO format,  
     &emsp;&emsp;&emsp;`electionName`: name of election,  
     &emsp;&emsp;&emsp;`organizerName`: name of organizer,  
    &emsp;&emsp;&emsp; `address`: address of deployed contract  
     &emsp;&emsp;&emsp;}  
    &emsp;}  
    }
    - "ELECTION ID" is the alphanumeric ID of the election and not the words literally
    - Each `Upcoming`, `Previous`, and `Ongoing` field contain another JSON of election ids each of which contains the fields mentioned above
    - The `address` field exists only if the contract has been deployed

- `Status code`: 401

  - `Return`: "Unauthorized"

- `Status code`: 400
  - `Return`: "bad request"

## `GET /api/election/{electionID}`

Gets the election data for the election corresponding to {electionID}  
Also tells whether the voter has voted or not and if they have then whom have they voted for

### URL parameter

- `electionID`: the ID of the election whose data is needed

### Request JSON

- EMPTY

### Response

- `Status code`: 200

  - `JSON returned`:  
    {  
     &emsp;`voted`: true/false,  
     &emsp;`votedFor`: index of the candidate for whom they voted for,  
     &emsp;`candidates`: array of candidates,  
     &emsp;`endTime`: end time of election in UTC in ISO format,  
     &emsp;`startTime`: start time of election in UTC is ISO format,  
     &emsp;`electionName`: name of election,  
     &emsp;`organizerName`: name of organizer,  
    &emsp;`address`: address of deployed contract  
    }
    - if `voted` is false then `votedFor` field won't exist

- `Status code`: 401

  - `Return`: "Unauthorized"

- `Status code`: 400
  - `Return`: "bad request"
